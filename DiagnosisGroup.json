{"paragraphs":[{"text":"val icd10QualityValueMapper: Map[String, List[String]] = Map(\"I5022\" -> List(\"\\\"I5022\\\":\\t\\\"CPT4008F\t- Beta-blocker therapy prescribed or currently being taken (CAD,HF)\\\"\", \"\\t\\t\\\"I5022\\\":\\t\\\"CPT 4010F - Angiotensin Converting Enzyme (ACE) Inhibitor or Angiotensin Receptor Blocker (ARB) therapy prescribed or currently being taken (CAD, CKD, HF) (DM)\\\"\", \"\\t\\t\\\"I5022\\\":\\t\\\"G9800\tBeta blocker allergy or contraindicate\\\"\", \"\\t\\t\\\"I5022\\\":\\t\\\"G8474\tACE or ARB Allergy or contraindicated\\\"\"),\n    \"F17.218\" -> List(\"CPT 4004F\tPatient screened for tobacco use AND received tobacco cessation intervention (counseling, pharmacotherapy, or both), if identified as a tobacco user (PV, CAD)\", \"CPT 1034F\tCurrent tobacco smoker (CAD, CAP, COPD, PV) (DM)\", \"CPT 1036F\tCurrent tobacco non-user (CAD, CAP, COPD, PV) (DM) (IBD)\", \"CPT 99406\tSmoking and tobacco use cessation counseling visit; intermediate, greater\tthan 3 minutes up to 10 minutes\"),\n    \"I10-1\" → List(\"\\\"I10-1\\\" :\\t\\\"CPT 3077F:\tMost recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\\\"\"),\n    \"I10\" → List(\"\\\"I10-1\\\" :\\t\\\"CPT 3077F:\tMost recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\\\"\"),\n    \"I10-2\" → List(\"\\\"I10-2\\\" :\\t\\\"CPT 3077F:\tMost recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\\\"\"),\n    \"R03.0\" → List(\"\\\"R03.0\\\" : \\t\\\"CPT 3077F:\tMost recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\\\"\"),\n    \"I160\" → List(\"\\\"I160\\\" :\\t\\\"CPT 3077F:\tMost recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\\\"\"),\n    \"N18.1\" -> List(\"\\\"N18.1\\\" : \\t\\\"CPT 3077F:\tMost recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\\\"\"),\n    \"I5032\" -> List(\"\"))\n\n  val hcpcsDiagnosisMapper: Map[String, String] = Map(\"I930050\" -> \"Stress Echocardiogram\",\n    \"93306\" -> \"2D TTE\",\n    \"93350\" -> \"Stress Echocardiogram\",\n    \"93005\" -> \"EKG\",\n    \"78451\" -> \"Nuclear Stress Test\",\n    \"93015\" -> \"Stress Test\",\n    \"93458\" -> \"Left Heart Catherterization\",\n    \"I78451\" -> \"Nuclear Stress Test\",\n    \"I93015\" -> \"Stress Test\",\n    \"I93458\" -> \"Left Heart Catherterization\",\n    \"E0601\" -> \"CPAP\",\n    \"I9580\" -> \"Sleep Study\",\n    \"G8924\" -> \"Spirometry\",\n    \"K0738\" -> \"Home Oxygen\",\n    \"I8280\" -> \"ABG\",\n    \"IE0471\" -> \"Respiratory assist device, bi-level pressure capability, with back-up rate feature\",\n    \"E0424\" -> \"Stationary compressed gaseous oxygen system, rental\",\n    \"E0434\" -> \"Portable liquid oxygen system, rental; includes portable container\",\n    \"IE0601\" -> \"Continuous positive airway pressure (cpap) device\",\n    \"\" -> \"\",\n    \"\" -> \"\")\n\n  val mapperDiagnosisQualityMetrics: Map[List[String], String] = Map(List(\"R73.03\", \"E11.65\") -> \"CPT 0513F\")\n\n  val qualityMetricsMapper: Map[String, String] = Map(\"CPT 0513F\" -> \"CPT 0513F- Elevated Blood pressure plan of care documented\",\n    \"CPT 4010F\" -> \"CPT 4010F- ACE Inhibitor or ARB prescribed or currently being taken\")\n\n\n  val diagnosisIcd10Map: Map[String, String] = Map(\n    \"\" -> \"\",\n\n    \"R73.03\" -> \"Pre Diabetes\",\n    \"E11.65\" -> \"Type 2 diabetes mellitus with hyperglycemia \",\n    \"E11.9\" -> \"Type 2 diabetes without complications\",\n\n    \"E782\" -> \"Mixed hyperlipidemia\",\n    \"I5022\" -> \"Chronic Systolic (Congestive) Heart Failure\",\n    \"J479\" -> \"Bronchiectasis, Uncomplicated\",\n\n    \"J9612\" -> \"Chronic Respiratory Failure With Hypercapnia\",\n    \"J439\" -> \"Emphysema, Unspecified\",\n    \"E785\" -> \"Hyperlipidemia, Unspecified\",\n    \"J411\" -> \"Mucopurulent Chronic Bronchitis\",\n    \"E781\" -> \"Pure Hyperglyceridemia\",\n\n    //Endocrine\n    \"E03.9\" -> \"Hypothyroidism, unspecified\",\n    \"I482\" -> \"Chronic Atrial Fibrillation\",\n    \"I5032\" -> \"Chronic Diastolic Heart Failure\",\n    \"J449\" -> \"Chr Bronchitis\",\n    \"J9611\" -> \"CRF w Hypoxia\",\n    \"G4733\" -> \"OSA\",\n\n    //Diabetes\n    //E11 Type 2 diabetes mellitus\n    //Use additional code to identify control using:\n    \"Z79.4\" -> \"insulin\",\n    \"Z79.84\" -> \"oral antidiabetic drugs, oral hypoglycemic drugs\",\n    \"E11.00\" -> \"Type 2 diabetes mellitus with hyperosmolarity without nonketotic hyperglycemic-hyperosmolar coma (NKHHC)\",\n    \"E11.01\" -> \"Type 2 diabetes mellitus with hyperosmolarity with coma\",\n    \"E11.21\" -> \"Type 2 diabetes mellitus with diabetic nephropathy\",\n    \"E11.22\" -> \"Type 2 diabetes mellitus with diabetic chronic kidney disease\",\n\n    //Use additional code to identify stage of chronic kidney disease (N18.1-N18.6)\n    \"E11.32\" -> \"Type 2 diabetes mellitus with mild nonproliferative diabetic retinopathy\",\n\n    //Type 2 diabetes mellitus with nonproliferative diabetic retinopathy NOS\n    //One of the following 7th characters is to be assigned to codes in subcategory E11.32 to designate\n    //laterality of the disease:\n    //1 - right eye\n    //2 - left eye\n    //3 - bilateral\n    \"E11.321\" -> \"Type 2 diabetes mellitus with mild nonproliferative diabetic retinopathy with macular edema\",\n    \"E11.329\" -> \"Type 2 diabetes mellitus with mild nonproliferative diabetic retinopathy without macular edema\",\n\n    //E11.33 Type 2 diabetes mellitus with moderate nonproliferative diabetic retinopathy\n    //One of the following 7th characters is to be assigned to codes in subcategory E11.33 to designate\n    //laterality of the disease:\n    //1 - right eye\n    //2 - left eye\n    //3 - bilateral\n    \"E11.331\" -> \"Type 2 diabetes mellitus with moderate nonproliferative diabetic retinopathy with macular edema\",\n    \"E11.339\" -> \"Type 2 diabetes mellitus with moderate nonproliferative diabetic retinopathy without macular edema\",\n\n    //E11.34 Type 2 diabetes mellitus with severe nonproliferative diabetic retinopathy\n    //One of the following 7th characters is to be assigned to codes in subcategory E11.34 to designate\n    //laterality of the disease:\n    //1 - right eye\n    //2 - left eye\n    //3 - bilateral\n    \"E11.341\" -> \"Type 2 diabetes mellitus with severe nonproliferative diabetic retinopathy with macular edema\",\n    \"E11.349\" -> \"Type 2 diabetes mellitus with severe nonproliferative diabetic retinopathy without macular edema\",\n\n    //E11.35 Type 2 diabetes mellitus with proliferative diabetic retinopathy\n    //One of the following 7th characters is to be assigned to codes in subcategory E11.35 to designate\n    //laterality of the disease:\n    //1 - right eye\n    //2 - left eye\n    //3 - bilateral\n    \"E11.351\" -> \"Type 2 diabetes mellitus with proliferative diabetic retinopathy with macular edema\",\n    \"E11.352\" -> \"Type 2 diabetes mellitus with proliferative diabetic retinopathy with traction retinal detachment involving the macula\",\n    \"E11.353\" -> \"Type 2 diabetes mellitus with proliferative diabetic retinopathy with traction retinal detachment not involving the macula\",\n    \"E11.355\" -> \"Type 2 diabetes mellitus with stable proliferative diabetic retinopathy\",\n    \"E11.359\" -> \"Type 2 diabetes mellitus with proliferative diabetic retinopathy without macular edema\",\n    \"E11.36\" -> \"Type 2 diabetes mellitus with diabetic cataract\",\n\n    //E11.37 Type 2 diabetes mellitus with diabetic macular edema, resolved following treatment\n    //One of the following 7th characters is to be assigned to code E11.37 to designate laterality of the\n    //disease:\n    //1 - right eye\n    //2 - left eye\n    //3 - bilateral\n    //9 - unspecified eye\n    \"E11.40\" -> \"Type 2 diabetes mellitus with diabetic neuropathy, unspecified\",\n    \"E11.41\" -> \"Type 2 diabetes mellitus with diabetic mononeuropathy\",\n    \"E11.42\" -> \"Type 2 diabetes mellitus with diabetic polyneuropathy\",\n    \"E11.43\" -> \"Type 2 diabetes mellitus with diabetic autonomic (poly)neuropathy, Type 2 diabetes mellitus with diabetic gastroparesis\",\n    \"E11.51\" -> \"Type 2 diabetes mellitus with diabetic peripheral angiopathy without gangrene\",\n    \"E11.52\" -> \"Type 2 diabetes mellitus with diabetic peripheral angiopathy with gangrene\",\n    \"E11.59\" -> \"Type 2 diabetes mellitus with other circulatory complications\",\n    \"E11.621\" -> \"Type 2 diabetes mellitus with foot ulcer. Use additional code to identify site of ulcer (L97.4-, L97.5-)\",\n    \"E11.622\" -> \"Type 2 diabetes mellitus with other skin ulcer Use additional code to identify site of ulcer (L97.1-L97.9, L98.41-L98.49)\",\n    \"E11.630\" -> \"Type 2 diabetes mellitus with periodontal disease\",\n    \"E11.64\" -> \"Type 2 diabetes mellitus with hypoglycemia\",\n    \"E11.641\" -> \"Type 2 diabetes mellitus with hypoglycemia with coma\",\n    \"E11.649\" -> \"Type 2 diabetes mellitus with hypoglycemia without coma\",\n    \"E11.65\" -> \"Type 2 diabetes mellitus with hyperglycemia\",\n    \"E28.2\" -> \"Polycystic ovarian syndrome\",\n    \"E44.0\" -> \"Moderate protein-calorie malnutrition\",\n    \"E44.1\" -> \"Mild protein-calorie malnutrition\",\n    \"E55.9\" -> \"Vitamin D deficiency, unspecified\",\n    \"E83.41\" -> \"Hypermagnesemia\",\n    \"E83.42\" -> \"Hypomagnesemia\",\n    \"E87.5\" -> \"Hyperkalemia\",\n    \"E87.6\" -> \"Hypokalemia\",\n    \"E66.01\" -> \"Morbid (severe) obesity due to excess calories\",\n    \"Z66.3\" -> \"Obesity Class I\",\n    \"Z68.37\" -> \"Obesity Class II\",\n    \"E66.2\" -> \"Morbid (severe) obesity with alveolar hypoventilation\",\n    \"E66.3\" -> \"Overweight \",\n    \"E88.81\" -> \"Metabolic syndrome Use additional codes for associated manifestations, such as:obesity (E66.-)\",\n    \"E78.5\" -> \"Pure hypercholesterolemia, unspecified (elevated LDL)\",\n    \"E78.1\" -> \"Pure hyperglyceridemia (elevated triglycerides)\",\n    \"E78.2\" -> \"Mixed hyperlipidemia (elevated triglyceridesand LDL)\",\n\n    //Hypertensive diseases (I10-I16)\n    //Use additional code to identify:\n    //exposure to environmental tobacco smoke (Z77.22)\n    //history of tobacco dependence (Z87.891)\n    //tobacco dependence (F17.-)\n    //tobacco use (Z72.0)\n    \"I16.0\" -> \"Hypertensive Urgency\",\n    \"I16.1\" -> \"Hypertensive Emergency\",\n\n    \"F17.218\" -> \"Nicotine dependence, cigarettes, w oth disorders\",\n\n    \"I60\" -> \"Hypertension Urgency\",\n    \"R03.0\" -> \"Pre Hypertension\",\n    \"I10\" -> \"Hypertension Diagnosis\",\n    \"I10-1\" -> \"Essential (primary) Stage 1 hypertension\",\n    \"I10-2\" -> \"Essential (Secondary) Stage 2 hypertension\",\n    \"I11\" -> \"Hypertensive heart disease Includes: any condition in I51.4-I51.9 due to hypertension\",\n    \"I11.0\" -> \"Hypertensive heart disease with heart failure. Use additional code to identify type of heart failure (I50.-) \",\n    \"I11.9\" -> \"Hypertensive heart disease without heart failure\",\n    \"I12\" -> \"Hypertensive chronic kidney disease Includes: any condition in N18 and N26 - due to hypertension nephrosclerosis\",\n    \"I12.0\" -> \"Hypertensive chronic kidney disease with stage 5 chronic kidney disease or end stage renal disease 1` xz\tUse additional code to identify the stage of chronic kidney disease (N18.5, N18.6)\",\n    \"I12.9\" -> \"Hypertensive chronic kidney disease with stage 1 through stage 4 chronic kidney disease Use additional code to identify the stage of chronic kidney disease (N18.1-N18.4, N18.9)\",\n\n    \"I13\" -> \"Hypertensive heart and chronic kidney disease Includes: any condition in I11.- with any condition in I12.- cardiorenal disease\",\n    \"I13.0\" -> \"Hypertensive heart and chronic kidney disease with heart failure and stage 1 through stage 4 chronic kidney disease, or unspecified chronic kidney disease\",\n    //Use additional code to identify type of heart failure (I50.-)\n    //Use additional code to identify stage of chronic kidney disease (N18.1-N18.4, N18.9)\n\n    \"I13.10\" -> \"Hypertensive heart and chronic kidney disease without heart failure, with stage 1 through stage 4 chronic kidney disease, or unspecified chronic kidney disease\",\n    //Use additional code to identify the stage of chronic kidney disease (N18.1-N18.4, N18.9)\n\n    \"I13.11\" -> \"Hypertensive heart and chronic kidney disease without heart failure, with stage 5 chronic kidney disease, or end stage renal disease\",\n    //Use additional code to identify the stage of chronic kidney disease (N18.5, N18.6)\n\n    \"I13.2\" -> \"Hypertensive heart and chronic kidney disease with heart failure and with stage 5 chronic kidney disease, or end stage renal disease\",\n    //Use additional code to identify type of heart failure (I50.-)\n    //Use additional code to identify the stage of chronic kidney disease (N18.5, N18.6)\n\n\n    \"I2510\" -> \"Atherosclerotic heart disease of native coronary artery without angina pectoris\",\n    \"I25.10\" -> \"Atherosclerotic heart disease of native coronary artery without angina pectoris\",\n    \"I25.9\" -> \"Chronic ischemic heart disease, unspecified\",\n    \"I42.0\" -> \"Dilated cardiomyopathy\",\n    \"I42.6\" -> \"Alcoholic cardiomyopathy Code also presence of alcoholism (F10.-)\",\n    \"I44.1\" -> \"Atrioventricular block, second degree Möbitz block block, type I and II\",\n    \"I44.2\" -> \"Atrioventricular block, complete\",\n    \"I44.4\" -> \"Left anterior fascicular block\",\n    \"I44.5\" -> \"Left posterior fascicular block \",\n    \"I44.7\" -> \"Left bundle-branch block, unspecified\",\n    \"I45.2\" -> \"Bifascicular block\",\n    \"I45.3\" -> \"Trifascicular block\",\n    \"I47.2\" -> \"Ventricular tachycardia\",\n    \"I48.0\" -> \"Paroxysmal atrial fibrillation\",\n    \"I48.1\" -> \"Persistent atrial fibrillation\",\n    \"I48.2\" -> \"Chronic atrial fibrillation\",\n    \"I49.5\" -> \"Sick sinus syndrome, Tachycardia-bradycardia syndrome\",\n    \"I50\" -> \"Heart failure Code first: heart failure due to hypertension (I11.0), heart failure due to hypertension with chronic kidney disease (I13.-)\",\n    \"I50.21\" -> \"Acute systolic (congestive) heart failure\",\n    \"I50.22\" -> \"Chronic systolic (congestive) heart failure\",\n    \"I50.23\" -> \"Acute on chronic systolic (congestive) heart failure\",\n    \"I50.31\" -> \"Acute diastolic (congestive) heart failure\",\n    \"I50.32\" -> \"Chronic diastolic (congestive) heart failure\",\n    \"I50.33\" -> \"Acute on chronic diastolic (congestive) heart failure\",\n    \"I50.41\" -> \"Acute combined systolic (congestive) and diastolic (congestive) heart failure\",\n    \"I50.42\" -> \"Chronic combined systolic (congestive) and diastolic (congestive) heart failure\",\n    \"I50.43\" -> \"Acute on chronic combined systolic (congestive) and diastolic (congestive) heart failure\",\n\n    \"I69.31\" -> \"Cognitive deficits following cerebral infarction\",\n    \"I69.310\" -> \"Attention and concentration deficit following cerebral infarction\",\n    \"I69.311\" -> \"Memory deficit following cerebral infarction\",\n    \"I69.312\" -> \"Visuospatial deficit and spatial neglect following cerebral infarction\",\n    \"I69.313\" -> \"Psychomotor deficit following cerebral infarction\",\n    \"I69.314\" -> \"Frontal lobe and executive function deficit following cerebral infarction\",\n    \"I69.315\" -> \"Cognitive social or emotional deficit following cerebral infarction\",\n\n    \"I69.32\" -> \"Speech and language deficits following cerebral infarction\",\n    \"I69.320\" -> \"Aphasia following cerebral infarction\",\n    \"I69.321\" -> \"Dysphasia following cerebral infarction\",\n    \"I69.322\" -> \"Dysarthria following cerebral infarction\",\n\n    \"I69.33\" -> \"Monoplegia of upper limb following cerebral infarction\",\n    \"I69.331\" -> \"Monoplegia of upper limb following cerebral infarction affecting right dominant side\",\n    \"I69.332\" -> \"Monoplegia of upper limb following cerebral infarction affecting left dominant side\",\n    \"I69.333\" -> \"Monoplegia of upper limb following cerebral infarction affecting right non-dominant side\",\n    \"I69.334\" -> \"Monoplegia of upper limb following cerebral infarction affecting left non-dominant side\",\n\n    \"I69.34\" -> \"Monoplegia of lower limb following cerebral infarction\",\n    \"I69.341\" -> \"Monoplegia of lower limb following cerebral infarction affecting right dominant side\",\n    \"I69.342\" -> \"Monoplegia of lower limb following cerebral infarction affecting left dominant side\",\n    \"I69.343\" -> \"Monoplegia of lower limb following cerebral infarction affecting right non-dominant side\",\n    \"I69.344\" -> \"Monoplegia of lower limb following cerebral infarction affecting left non-dominant side\",\n\n    \"I69.35\" -> \"Hemiplegia and hemiparesis following cerebral infarction\",\n    \"I69.351\" -> \"Hemiplegia and hemiparesis following cerebral infarction affecting right dominant side\",\n    \"I69.352\" -> \"Hemiplegia and hemiparesis following cerebral infarction affecting left dominant side\",\n    \"I69.353\" -> \"Hemiplegia and hemiparesis following cerebral infarction affecting right non-dominant side\",\n    \"I69.354\" -> \"Hemiplegia and hemiparesis following cerebral infarction affecting left non-dominant side\",\n\n    \"I69.391\" -> \"Dysphagia following cerebral infarction (?PEG)\",\n\n    //Chronic Respiratory disease\n    //Use additional code to identify:\n    //exposure to environmental tobacco smoke (Z77.22)\n    //exposure to tobacco smoke in the perinatal period (P96.81)\n    //history of tobacco dependence (Z87.891)\n    //occupational exposure to environmental tobacco smoke (Z57.31)\n    //tobacco dependence (F17.-)\n    //tobacco use (Z72.0)\n\n    \"J41.0\" -> \"Simple chronic bronchitis\",\n    \"J41.1\" -> \"Mucopurulent chronic bronchitis\",\n    \"J41.8\" -> \"Mixed simple and mucopurulent chronic bronchitis\",\n    \"J43.9\" -> \"Emphysema, unspecified\",\n    \"J45.20\" -> \"Mild intermittent asthma, uncomplicated\",\n    \"J45.21\" -> \"Mild intermittent asthma with (acute) exacerbation\",\n    \"J45.30\" -> \"Mild persistent asthma, uncomplicated\",\n    \"J45.31\" -> \"Mild persistent asthma with (acute) exacerbation \",\n    \"J45.40\" -> \"Moderate persistent asthma, uncomplicated\",\n    \"J45.41\" -> \"Moderate persistent asthma with (acute) exacerbation\",\n\n    \"J96.00\" -> \"Acute respiratory failure, unspecified whether with hypoxia or hypercapnia\",\n    \"J96.01\" -> \"Acute respiratory failure with hypoxia\",\n    \"J96.02\" -> \"Acute respiratory failure with hypercapnia\",\n\n    \"J96.10\" -> \"Chronic respiratory failure, unspecified whether with hypoxia or hypercapnia\",\n    \"J96.11\" -> \"Chronic respiratory failure with hypoxia\",\n    \"J96.12\" -> \"Chronic respiratory failure with hypercapnia\",\n\n    \"J96.20\" -> \"Acute and chronic respiratory failure, unspecified whether with hypoxia or hypercapnia\",\n    \"J96.21\" -> \"Acute and chronic respiratory failure with hypoxia\",\n    \"J96.22\" -> \"Acute and chronic respiratory failure with hypercapnia\",\n\n    \"M16.11\" -> \"Unilateral primary osteoarthritis, right hip\",\n    \"M16.12\" -> \"Unilateral primary osteoarthritis, left hip\",\n    \"M16.0\" -> \"Bilateral primary osteoarthritis of hip\",\n\n    \"M17.11\" -> \"Unilateral primary osteoarthritis, right knee\",\n    \"M17.12\" -> \"Unilateral primary osteoarthritis, left knee\",\n    \"M17.0\" -> \"Bilateral primary osteoarthritis of knee\",\n\n    \"M22.2X1\" -> \"Patellofemoral disorders, right knee\",\n    \"M22.2X2\" -> \"Patellofemoral disorders, left knee\",\n\n    //Code first any associated:\n    //diabetic chronic kidney disease (E08.22, E09.22, E10.22, E11.22, E13.22)\n    //hypertensive chronic kidney disease (I12.-, I13.-)\n\n    \"N18.1\" -> \"Chronic kidney disease, stage 1\",\n    \"N18.2\" -> \"Chronic kidney disease, stage 2 (mild)\",\n    \"N18.3A\" -> \"Chronic kidney disease, stage 3A (moderate)\",\n    \"N18.3B\" -> \"Chronic kidney disease, stage 3B (moderate)\",\n    \"N18.4\" -> \"Chronic kidney disease, stage 4 (severe)\",\n    \"N18.5\" -> \"Chronic kidney disease, stage 5 Excludes1: chronic kidney disease, stage 5 requiring chronic dialysis (N18.6) \",\n    \"N18.6\" -> \"End stage renal disease. Chronic kidney disease requiring chronic dialysis Use additional code to identify dialysis status (Z99.2)\")","user":"admin","dateUpdated":"2018-04-11T16:23:14+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"icd10QualityValueMapper: Map[String,List[String]] = Map(F17.218 -> List(CPT 4004F\tPatient screened for tobacco use AND received tobacco cessation intervention (counseling, pharmacotherapy, or both), if identified as a tobacco user (PV, CAD), CPT 1034F\tCurrent tobacco smoker (CAD, CAP, COPD, PV) (DM), CPT 1036F\tCurrent tobacco non-user (CAD, CAP, COPD, PV) (DM) (IBD), CPT 99406\tSmoking and tobacco use cessation counseling visit; intermediate, greater\tthan 3 minutes up to 10 minutes), R03.0 -> List(\"R03.0\" : \t\"CPT 3077F:\tMost recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\"), I10-1 -> List(\"I10-1\" :\t\"CPT 3077F:\tMost recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\"), I10 -> List(\"I10-1\" :\t\"CPT 3077F:\tMost recent ...hcpcsDiagnosisMapper: Map[String,String] = Map(I8280 -> ABG, \"\" -> \"\", 93015 -> Stress Test, E0601 -> CPAP, IE0471 -> Respiratory assist device, bi-level pressure capability, with back-up rate feature, 93005 -> EKG, G8924 -> Spirometry, IE0601 -> Continuous positive airway pressure (cpap) device, 78451 -> Nuclear Stress Test, E0424 -> Stationary compressed gaseous oxygen system, rental, I930050 -> Stress Echocardiogram, 93458 -> Left Heart Catherterization, 93306 -> 2D TTE, E0434 -> Portable liquid oxygen system, rental; includes portable container, I78451 -> Nuclear Stress Test, I93015 -> Stress Test, K0738 -> Home Oxygen, I93458 -> Left Heart Catherterization, 93350 -> Stress Echocardiogram, I9580 -> Sleep Study)\nmapperDiagnosisQualityMetrics: Map[List[String],String] = Map(List(R73.03, E11.65) -> CPT 0513F)\nqualityMetricsMapper: Map[String,String] = Map(CPT 0513F -> CPT 0513F- Elevated Blood pressure plan of care documented, CPT 4010F -> CPT 4010F- ACE Inhibitor or ARB prescribed or currently being taken)\ndiagnosisIcd10Map: Map[String,String] = Map(I69.352 -> Hemiplegia and hemiparesis following cerebral infarction affecting left dominant side, I13.10 -> Hypertensive heart and chronic kidney disease without heart failure, with stage 1 through stage 4 chronic kidney disease, or unspecified chronic kidney disease, I69.34 -> Monoplegia of lower limb following cerebral infarction, M22.2X2 -> Patellofemoral disorders, left knee, E11.42 -> Type 2 diabetes mellitus with diabetic polyneuropathy, \"\" -> \"\", I69.341 -> Monoplegia of lower limb following cerebral infarction affecting right dominant side, N18.3A -> Chronic kidney disease, stage 3A (moderate), E11.65 -> Type 2 diabetes mellitus with hyperglycemia, E11.353 -> Type 2 diabetes mellitus with proliferative diabetic retinopathy with tractio..."}]},"apps":[],"jobName":"paragraph_1523443716578_-474348046","id":"20180411-161836_1416165003","dateCreated":"2018-04-11T16:18:36+0530","dateStarted":"2018-04-11T16:23:14+0530","dateFinished":"2018-04-11T16:23:18+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:410"},{"text":"//  val mapBDToAge: (String) => Int = (unformattedBirthDate: String) => {\n//     val splitOnSpace = unformattedBirthDate.split(\" \")(0)\n//     val splitOnHypen = splitOnSpace.split('/')\n//     val birthDate: LocalDate = new LocalDate(splitOnHypen(2).toInt, splitOnHypen(1).toInt, splitOnHypen(0).toInt)\n//     val now: LocalDate = new LocalDate()\n//     val age: Years = Years.yearsBetween(birthDate, now)\n//     age.getYears\n//   }\n\n  //Declare the UDF\n//  val addAgeColumnUDF= udf(mapBDToAge)\n\n\n\n\n  val mapHCPCSToDiagnosis: (String) => String = (HCPCSIcd10: String) => {\n    var diagnosis = \"\"\n    if(HCPCSIcd10 != null && HCPCSIcd10 != \"\") {\n      val arr = HCPCSIcd10.split(\"\\\\|\").map(_.trim)\n      for (i <- 0 to arr.size - 1) {\n        diagnosis = diagnosis + \"\\t\\t{  \\\"10/01/2009 02:50\\\": \\\"\" + (hcpcsDiagnosisMapper(arr(i)) + \"\\\" - \\\"\" + arr(i) + \"\\\"   }\\n \")\n      }\n      diagnosis\n    } else \"\"\n  }\n\n  val mapIcd10ToDiagnosis: (Any) => String = (icd9: Any) => {\n    if (icd9 != null && icd9 != \"\") {\n      diagnosisIcd10Map.get(icd9.toString) match {\n        case Some(diag) => diag\n        case None => \"\"\n      }\n    } else {\n      \"\"\n    }\n  }\n\n  val mapBPToICD10: (Int, Int) => String = (sbp: Int, dbp: Int) => {\n\n      if ((sbp >= 140 && sbp <= 159) || (dbp >= 90 && dbp <= 99)) {\n        \"I10-1\"\n      } else if ((sbp >= 160 && sbp <= 179) || (dbp >= 100 && dbp <= 199)) {\n        \"I10-2\"\n      } else if ((sbp >= 120 && sbp <= 139) || (dbp >= 80 && dbp <= 89)) {\n        \"R03.0\"\n      } else if ((sbp < 120) || (dbp < 80)) {\n        \"\"\n      } else if (sbp > 180 && dbp > 105) {\n        \"I160(I16.0)\"\n      }\n      else \"\" /*\"I160(I16.0)\"*/\n\n  }\n\n  val mapBMItoICD10: (Double) => String = (bmi: Double) => {\n    //val bmi = bmiRaw.toDouble\n    if ((bmi >= 25.0 && bmi <= 29.9)) {\n      \"E66.3\"\n    } else if ((bmi >= 30.0 && bmi <= 34.9)) {\n      \"Z66.3\"\n    } else if ((bmi >= 35.0 && bmi <= 39.9)) {\n      \"Z68.37\"\n    } else if ((bmi > 40)) {\n      \"E66.01\"\n    }\n    else \"\"\n  }\n\n  val joinQualityValueDataFrameWithDiagnosis: (Int, String, String, String, String, String) => String = (age: Int, icd10_dgns: String, ckd: String, hemoglobinA1c: String, bp: String, ldl: String) => {\n\n    val icd10_dgns1: String = icd10QualityValueMapper(icd10_dgns).mkString(\"\\n\")\n    var qualityValue = \"\"\n\n    if (hemoglobinA1c == \"E11.65\") qualityValue += (\"\\n\\\"\" + hemoglobinA1c + \"\\\" : \\t \\\"CPT 3045F - Most recent hemoglobin A1c (HbA1c) level 7.0-9.0% (DM)\\\"\")\n    else if(hemoglobinA1c == \"E11.9\") qualityValue += (\"\\n\\\"\" + hemoglobinA1c + \"\\\": \\t \\\"CPT 3046F - Most recent hemoglobin A1c level greater than 9.0% (DM)\\\"\")\n    //if (age < 80) {\n\n\n    if (ckd == \"N18.3\" || ckd == \"N18.4\" || ckd == \"N18.5\" || ckd == \"N18.6\") {\n\n      qualityValue += (\"\\n\\\"\" + ckd + \"\\\" : \\t \\\"CPT 0513F- Elevated blood pressure plan of care documented (CKD)\\\"\" + \"\\n\\\"\" + ckd + \"\\\" : \\t \\\"CPT 4010F Angiotensin Converting Enzyme (ACE) Inhibitor or Angiotensin Receptor Blocker (ARB) therapy prescribed or currently being taken (CAD, CKD, HF) (DM) \\\"\")\n\n      if (bp == \"I10-1\") {\n        qualityValue += (\"\\n\\\"\" + bp + \"\\\" : \\t \\\"CPT 3077F - Most recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\\\\””),\\\"\" + \"\\n\\\"\" + bp + \"\\\" : \\t \\\"CPT 3080F - Most recent diastolic blood pressure greater than or equal to 90 mm Hg (HTN, CKD, CAD) (DM)\\\"\")\n      }\n\n      if (bp == \"I10-2\") {\n        qualityValue += (\"\\n\\\"\" + bp + \"\\\" : \\t \\\"CPT 3077F - Most recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\\\\””),\\\"\" + \"\\n\\\"\" + bp + \"\\\" : \\t \\\"CPT 3080F - Most recent diastolic blood pressure greater than or equal to 90 mm Hg (HTN, CKD, CAD) (DM)\\\"\")\n      }\n\n      if (bp == \"R03.0\") {\n        qualityValue += (\"\\n\\\"\" + bp + \"\\\" : \\t \\\"CPT 3077F - Most recent systolic blood pressure greater than or equal to 140 mm Hg (HTN, CKD, CAD) (DM)\\\\””),\\\"\" + \"\\n\\\"\" + bp + \"\\\" : \\t \\\"CPT 3080F - Most recent diastolic blood pressure greater than or equal to 90 mm Hg (HTN, CKD, CAD) (DM)\\\"\")\n      }\n\n      if (ldl == \"E78.5\") {\n        qualityValue += (\"\\n\\\"\" + ldl + \"\\\" : \\t\\\"CPT 3048F - Most recent LDL-C less than 100 mg/dL (CAD) (DM)\\\"\" + \"\\n\\\"\" + ldl + \"\\\" : \\t\\\"CPT 3049F-\tMost recent LDL-C 100-129 mg/dL (CAD) (DM)\\\"\" + \"\\n\\\"\" + ldl + \"\\\" : \\t\\\"CPT 3050F -Most recent LDL-C greater than or equal to 130 mg/dL (CAD) (DM)\\\"\" + \"\\n\\\"\" + ldl + \"\\\" : \\t\\\"CPT 0556F-\tPlan of care to achieve lipid control documented (CAD)\\\"\" + \"\\n\\\"\" + ldl + \"\\\" : \\t\\\"CPT 4013F\tStatin therapy prescribed or currently being taken (CAD)\\\"\")\n\n      }\n\n    } else if (ckd == \"N18.1\" || ckd == \"N18.2\") \"\" //N18.1 & N18.2 yet to derive CPT\n\n    //  } else \" \\n\\\"Age \" + age + \" greater than 80 yet to do assessment\"\n\n    // var bp_icd101: String = icd10QualityValueMapper.getOrElse(bp_icd10, List(\"\")).mkString(\"\\n\")\n\n\n    icd10_dgns1 + qualityValue\n  }\n\n  val mapDiastolicIcd10ToDiagnosis: (String) => String = (DiastolicIcd10: String) => {\n    if(DiastolicIcd10 == null || DiastolicIcd10 == \"\") \"\"\n    else {\n      val diagnosis = diagnosisIcd10Map(DiastolicIcd10)\n      diagnosis\n    }\n  }\n\n\n  val addIcd10DiagnosisUDF = udf(mapIcd10ToDiagnosis)\n\n  //Declare the UDF\n  val addHCPCSUDF = udf(mapHCPCSToDiagnosis)\n  val addRespiratoryUDF = udf(mapHCPCSToDiagnosis)\n  val func = udf(mapBPToICD10)\n  val addBMIUDF = udf(mapBMItoICD10)\n  val addDiastolicUDF = udf(mapDiastolicIcd10ToDiagnosis)\n  //val addPlanUDF = udf(mapAssessmentToMedication)\n\n\n  val vitalsDataFrame = spark.read.option(\"header\", \"true\").csv(\"/home/ashish/Desktop/cynapse/raw-data/vitals.csv\")\n    .select(\"Patient_oid\", \"PatientVisit_oid\", \"BirthDate\", \"VisitType\", \"Payer_ID\",\"AT_PHYSN_NPI\",\"SBP\", \"DBP\", \"HeartRate\", \"Respiration\", \"BMI\",\"Temperature\",\"CreationTime\")\n    .withColumn(\"CLM_FROM_DT\", expr(\"null\"))\n    .withColumn(\"CLM_THRU_DT\", expr(\"null\"))\n    .withColumn(\"ICD10_Code\", expr(\"null\"))\n    .withColumn(\"ICD10_DGNS_CD_1\", expr(\"null\"))\n    .withColumn(\"HCPCS_CD_1\", expr(\"null\"))\n    .withColumn(\"HCPCS_CD_2\", expr(\"null\"))\n    .withColumn(\"HCPCS_CD_3\", expr(\"null\"))\n    .withColumn(\"HCPCS_CD_4\", expr(\"null\"))\n\n  println(\"\\n count of vitalsDataFrame :\")\n  println(vitalsDataFrame.count())\n  println(\"\\n\\n\")\n\n\n  val systolicDataFrame = spark.read.option(\"header\", \"true\").csv(\"/home/ashish/Desktop/cynapse/raw-data/systolic.csv\")\n    .withColumn(\"SBP\", expr(\"null\"))\n    .withColumn(\"DBP\", expr(\"null\"))\n    .withColumn(\"HeartRate\", expr(\"null\"))\n    .withColumn(\"Respiration\", expr(\"null\"))\n    .withColumn(\"BMI\", expr(\"null\"))\n    .withColumn(\"Temperature\", expr(\"null\"))\n    .withColumn(\"CreationTime\", expr(\"null\"))\n    .select(\"Patient_oid\", \"PatientVisit_oid\", \"BirthDate\", \"VisitType\", \"Payer_ID\",\"AT_PHYSN_NPI\",\"SBP\", \"DBP\", \"HeartRate\", \"Respiration\", \"BMI\",\"Temperature\",\"CreationTime\",\"CLM_FROM_DT\",\"CLM_THRU_DT\",\"ICD10_Code\",\"ICD10_DGNS_CD_1\",\"HCPCS_CD_1\",\"HCPCS_CD_2\",\"HCPCS_CD_3\",\"HCPCS_CD_4\")\n\n  println(\"\\n count of systolicDataFrame :\")\n  println(systolicDataFrame.count())\n  println(\"\\n\\n\")\n\n\n\n\n  val mergedDF = vitalsDataFrame.union(systolicDataFrame)\n  //val unorderedMergedDf = mergedDF.na.fill(\"\",Seq())\n  //unorderedMergedDf.show()\n\n  val orderedMergedDataFrame = mergedDF.orderBy(asc(\"Patient_oid\"), desc(\"PatientVisit_oid\"))\n\n // val dataFrameWithAge = orderedMergedDataFrame.withColumn(\"AGE\", addAgeColumnUDF(orderedMergedDataFrame(\"BirthDate\")))\n  //vitalsDataFrame.join(systolicDataFrame,\"PatientVisit_oid\", \"fullouter\")\n\n  val orderedVitalsDataFrameWithBPICD10 = orderedMergedDataFrame.withColumn(\"BP_ICD10\", func(orderedMergedDataFrame(\"SBP\"), orderedMergedDataFrame(\"DBP\")))\n\n  val orderedVitalsDataFrameWithBPICD10Diag = orderedVitalsDataFrameWithBPICD10.withColumn(\"BP_DIAGNOSIS_ICD10\", addIcd10DiagnosisUDF(orderedVitalsDataFrameWithBPICD10(\"BP_ICD10\")))\n\n  val orderedVitalsDataFrameWithBMIICD10 = orderedVitalsDataFrameWithBPICD10Diag.withColumn(\"BMI_ICD10\", addBMIUDF(orderedVitalsDataFrameWithBPICD10Diag(\"BMI\")))\n\n  val orderedVitalsDataFrameWithBMIICD10Diag = orderedVitalsDataFrameWithBMIICD10.withColumn(\"BMI_DIAGNOSIS_ICD10\", addIcd10DiagnosisUDF(orderedVitalsDataFrameWithBMIICD10(\"BMI_ICD10\")))\n\n  val n = orderedVitalsDataFrameWithBMIICD10Diag.withColumn(\"ICD_10_Code_Diagnosis\", addDiastolicUDF(orderedVitalsDataFrameWithBMIICD10Diag(\"ICD10_Code\")))\n  val m = n.withColumn(\"ICD10_DGNS_CD_1_Diagnosis\", addDiastolicUDF(n(\"ICD10_DGNS_CD_1\")))\n  val h = m.withColumn(\"HCPCS_CD_1_Diagnosis\", addHCPCSUDF(m(\"HCPCS_CD_1\")))\n  val k = h.withColumn(\"HCPCS_CD_2_Diagnosis\", addHCPCSUDF(h(\"HCPCS_CD_2\")))\n  val l = k.withColumn(\"HCPCS_CD_3_Diagnosis\", addHCPCSUDF(k(\"HCPCS_CD_3\")))\n  val z = l.withColumn(\"HCPCS_CD_4_Diagnosis\", addHCPCSUDF(l(\"HCPCS_CD_4\")))\n\n  val final_df = z.na.fill(\"\",Seq(\"Patient_oid\", \"PatientVisit_oid\", \"BirthDate\", \"VisitType\", \"Payer_ID\",\"AT_PHYSN_NPI\",\"SBP\", \"DBP\", \"HeartRate\", \"Respiration\", \"BMI\",\"Temperature\",\"CreationTime\",\"CLM_FROM_DT\",\"CLM_THRU_DT\",\"ICD10_Code\",\"ICD10_DGNS_CD_1\",\"HCPCS_CD_1\",\"HCPCS_CD_2\",\"HCPCS_CD_3\",\"HCPCS_CD_4\",\"BMI_ICD10\",\"BP_ICD10\",\"BP_DIAGNOSIS_ICD10\",\"BMI_DIAGNOSIS_ICD10\",\"ICD_10_Code_Diagnosis\",\"HCPCS_CD_1_Diagnosis\", \"HCPCS_CD_2_Diagnosis\", \"HCPCS_CD_3_Diagnosis\", \"HCPCS_CD_4_Diagnosis\"))\n  \n  final_df.select(\"ICD10_Code\", \"HCPCS_CD_1\",\"HCPCS_CD_2\",\"HCPCS_CD_3\",\"HCPCS_CD_4\",\"BMI_ICD10\",\"BP_ICD10\").show()","user":"admin","dateUpdated":"2018-04-11T16:45:12+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mapHCPCSToDiagnosis: String => String = <function1>\nmapIcd10ToDiagnosis: Any => String = <function1>\nmapBPToICD10: (Int, Int) => String = <function2>\nmapBMItoICD10: Double => String = <function1>\njoinQualityValueDataFrameWithDiagnosis: (Int, String, String, String, String, String) => String = <function6>\nmapDiastolicIcd10ToDiagnosis: String => String = <function1>\naddIcd10DiagnosisUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,None)\naddHCPCSUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\naddRespiratoryUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\nfunc: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function2>,StringType,Some(List(IntegerType, IntegerType)))\naddBMIUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(DoubleType)))\naddDiastolicUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\nvitalsDataFrame: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 19 more fields]\n\n count of vitalsDataFrame :\n8\n\n\n\nsystolicDataFrame: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 19 more fields]\n\n count of systolicDataFrame :\n5\n\n\n\nmergedDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Patient_oid: string, PatientVisit_oid: string ... 19 more fields]\norderedMergedDataFrame: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Patient_oid: string, PatientVisit_oid: string ... 19 more fields]\norderedVitalsDataFrameWithBPICD10: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 20 more fields]\norderedVitalsDataFrameWithBPICD10Diag: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 21 more fields]\norderedVitalsDataFrameWithBMIICD10: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 22 more fields]\norderedVitalsDataFrameWithBMIICD10Diag: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 23 more fields]\nn: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 24 more fields]\nm: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 25 more fields]\nh: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 26 more fields]\nk: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 27 more fields]\nl: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 28 more fields]\nz: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 29 more fields]\nfinal_df: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 29 more fields]\n+----------+----------+----------+----------+----------+---------+--------+\n|ICD10_Code|HCPCS_CD_1|HCPCS_CD_2|HCPCS_CD_3|HCPCS_CD_4|BMI_ICD10|BP_ICD10|\n+----------+----------+----------+----------+----------+---------+--------+\n|          |          |          |          |          |   E66.01|   I10-1|\n|          |          |          |          |          |   E66.01|   I10-1|\n|     I5022|          |          |     93005|          |         |        |\n|          |          |          |          |          |         |   I10-2|\n|          |          |          |          |          |   E66.01|   I10-1|\n|     I5022|     93306|     78451|     93005|     93458|         |        |\n|     I5022|     93306|     78451|     93005|     93458|         |        |\n|     I5022|     93306|     93350|     93005|     93458|         |        |\n|     I5022|          |          |     93005|          |         |        |\n|          |          |          |          |          |   Z68.37|   I10-1|\n|          |          |          |          |          |   Z68.37|   I10-1|\n|          |          |          |          |          |         |   I10-2|\n|          |          |          |          |          |   Z68.37|   I10-1|\n+----------+----------+----------+----------+----------+---------+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1523443695751_-105004426","id":"20180411-161815_1931273957","dateCreated":"2018-04-11T16:18:15+0530","dateStarted":"2018-04-11T16:45:12+0530","dateFinished":"2018-04-11T16:45:22+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:411"},{"text":"val diagnosisGroupMap = Map(\"I5021\" -> \"Cardiology\",\"I5022\" -> \"Cardiology\",\"I5023\" -> \"Cardiology\", \"I5031\" -> \"Cardiology\", \"I5032\" -> \"Cardiology\", \n                        \"I5033\" -> \"Cardiology\", \"I504\" -> \"Cardiology\", \"I5041\" -> \"Cardiology\", \"I5042\" -> \"Cardiology\", \"I5043\" -> \"Cardiology\",\n                        \"I259\" -> \"Cardiology\", \"I480\" -> \"Cardiology\", \"I481\" -> \"Cardiology\", \"I482\" -> \"Cardiology\", \"I483\" -> \"Cardiology\", \"E66.01\" -> \"Cardiology, Pulmonary, Internal Medicine\",\n                        \"J439\" -> \"Pulmonary\", \"J449\" -> \"Pulmonary\", \"J411\" -> \"Pulmonary\", \"J960\" -> \"Pulmonary\", \"J9601\" -> \"Pulmonary\", \"J9602\" -> \"Pulmonary\",\n                        \"J961\" -> \"Pulmonary\", \"J9611\" -> \"Pulmonary\", \"J9612\" -> \"Pulmonary\", \"J962\" -> \"Pulmonary\", \"J9621\"-> \"Pulmonary\", \"J9622\" -> \"Pulmonary\", \"G4733\" -> \"Pulmonary\")","user":"admin","dateUpdated":"2018-04-11T19:23:14+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"diagnosisGroupMap: scala.collection.immutable.Map[String,String] = Map(J9621 -> Pulmonary, J9602 -> Pulmonary, J961 -> Pulmonary, I5023 -> Cardiology, J439 -> Pulmonary, I483 -> Cardiology, I259 -> Cardiology, G4733 -> Pulmonary, I5041 -> Cardiology, J449 -> Pulmonary, I482 -> Cardiology, J962 -> Pulmonary, J411 -> Pulmonary, J9601 -> Pulmonary, I5021 -> Cardiology, I504 -> Cardiology, I5031 -> Cardiology, I481 -> Cardiology, I5042 -> Cardiology, J9612 -> Pulmonary, J9622 -> Pulmonary, I5022 -> Cardiology, J9611 -> Pulmonary, I5033 -> Cardiology, J960 -> Pulmonary, I5043 -> Cardiology, E66.01 -> Cardiology, Pulmonary, Internal Medicine, I5032 -> Cardiology, I480 -> Cardiology)\n"}]},"apps":[],"jobName":"paragraph_1523444013174_-1627426820","id":"20180411-162333_1791690315","dateCreated":"2018-04-11T16:23:33+0530","dateStarted":"2018-04-11T19:23:15+0530","dateFinished":"2018-04-11T19:23:15+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:412"},{"text":"//val diagnosisGroupSet = scala.collection.mutable.Set[String]()\n\ndef addDiagnosisGroup(icd10Code: String,hcpcsCode1: String,hcpcsCode2: String,hcpcsCode3: String,hcpcsCode4: String,bmiIcd10Code: String,bpIcd10Code: String): String =\n{\n    val diagnosisGroupSet = new scala.collection.mutable.ArrayBuffer[String]()\n    diagnosisGroupSet += diagnosisGroupMap.getOrElse(icd10Code, \"\")\n    diagnosisGroupSet += diagnosisGroupMap.getOrElse(hcpcsCode1, \"\")\n    diagnosisGroupSet += diagnosisGroupMap.getOrElse(hcpcsCode2, \"\")\n    diagnosisGroupSet += diagnosisGroupMap.getOrElse(hcpcsCode3, \"\")\n    diagnosisGroupSet += diagnosisGroupMap.getOrElse(hcpcsCode4, \"\")\n    diagnosisGroupSet += diagnosisGroupMap.getOrElse(bmiIcd10Code, \"\")\n    diagnosisGroupSet += diagnosisGroupMap.getOrElse(bpIcd10Code, \"\")\n    diagnosisGroupSet.mkString(\" \")\n}\n\nval addDiagnosisGroupUDF = udf(addDiagnosisGroup _)\nval dff = final_df.withColumn(\"DiagnosisGroup\", addDiagnosisGroupUDF(final_df(\"ICD10_Code\"), final_df(\"HCPCS_CD_1\"), final_df(\"HCPCS_CD_2\"), final_df(\"HCPCS_CD_3\"), final_df(\"HCPCS_CD_4\"), final_df(\"BMI_ICD10\"), final_df(\"BP_ICD10\")))\n\ndff.printSchema\n\ndff.select(\"Patient_oid\",\"PatientVisit_oid\",\"ICD10_Code\", \"HCPCS_CD_1\",\"HCPCS_CD_2\",\"HCPCS_CD_3\",\"HCPCS_CD_4\",\"BMI_ICD10\",\"BP_ICD10\",\"DiagnosisGroup\").show()","user":"admin","dateUpdated":"2018-04-11T18:29:27+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"addDiagnosisGroup: (icd10Code: String, hcpcsCode1: String, hcpcsCode2: String, hcpcsCode3: String, hcpcsCode4: String, bmiIcd10Code: String, bpIcd10Code: String)String\naddDiagnosisGroupUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function7>,StringType,Some(List(StringType, StringType, StringType, StringType, StringType, StringType, StringType)))\ndff: org.apache.spark.sql.DataFrame = [Patient_oid: string, PatientVisit_oid: string ... 30 more fields]\nroot\n |-- Patient_oid: string (nullable = false)\n |-- PatientVisit_oid: string (nullable = false)\n |-- BirthDate: string (nullable = false)\n |-- VisitType: string (nullable = false)\n |-- Payer_ID: string (nullable = false)\n |-- AT_PHYSN_NPI: string (nullable = false)\n |-- SBP: string (nullable = false)\n |-- DBP: string (nullable = false)\n |-- HeartRate: string (nullable = false)\n |-- Respiration: string (nullable = false)\n |-- BMI: string (nullable = false)\n |-- Temperature: string (nullable = false)\n |-- CreationTime: string (nullable = false)\n |-- CLM_FROM_DT: string (nullable = false)\n |-- CLM_THRU_DT: string (nullable = false)\n |-- ICD10_Code: string (nullable = false)\n |-- ICD10_DGNS_CD_1: string (nullable = false)\n |-- HCPCS_CD_1: string (nullable = false)\n |-- HCPCS_CD_2: string (nullable = false)\n |-- HCPCS_CD_3: string (nullable = false)\n |-- HCPCS_CD_4: string (nullable = false)\n |-- BP_ICD10: string (nullable = false)\n |-- BP_DIAGNOSIS_ICD10: string (nullable = false)\n |-- BMI_ICD10: string (nullable = false)\n |-- BMI_DIAGNOSIS_ICD10: string (nullable = false)\n |-- ICD_10_Code_Diagnosis: string (nullable = false)\n |-- ICD10_DGNS_CD_1_Diagnosis: string (nullable = true)\n |-- HCPCS_CD_1_Diagnosis: string (nullable = false)\n |-- HCPCS_CD_2_Diagnosis: string (nullable = false)\n |-- HCPCS_CD_3_Diagnosis: string (nullable = false)\n |-- HCPCS_CD_4_Diagnosis: string (nullable = false)\n |-- DiagnosisGroup: string (nullable = true)\n\n+-----------+----------------+----------+----------+----------+----------+----------+---------+--------+--------------------+\n|Patient_oid|PatientVisit_oid|ICD10_Code|HCPCS_CD_1|HCPCS_CD_2|HCPCS_CD_3|HCPCS_CD_4|BMI_ICD10|BP_ICD10|      DiagnosisGroup|\n+-----------+----------------+----------+----------+----------+----------+----------+---------+--------+--------------------+\n|    1065908|         7081335|          |          |          |          |          |   E66.01|   I10-1|     Cardiology, ...|\n|    1065908|         6684852|          |          |          |          |          |   E66.01|   I10-1|     Cardiology, ...|\n|    1065908|665AB2AFAF9B524A|     I5022|          |          |     93005|          |         |        |    Cardiology      |\n|    1065908|         6569499|          |          |          |          |          |         |   I10-2|                    |\n|    1065908|         6346364|          |          |          |          |          |   E66.01|   I10-1|     Cardiology, ...|\n|    1065908|5CE15C94868B89F2|     I5022|     93306|     78451|     93005|     93458|         |        |    Cardiology      |\n|    1065908|449879CFA30A08C6|     I5022|     93306|     78451|     93005|     93458|         |        |    Cardiology      |\n|    4803902|A6B28CE8DE42FAC6|     I5022|     93306|     93350|     93005|     93458|         |        |    Cardiology      |\n|    4803902|832BF45E1D77CBB4|     I5022|          |          |     93005|          |         |        |    Cardiology      |\n|    4803902|         7388629|          |          |          |          |          |   Z68.37|   I10-1|                    |\n|    4803902|         7124781|          |          |          |          |          |   Z68.37|   I10-1|                    |\n|    4803902|         7005002|          |          |          |          |          |         |   I10-2|                    |\n|    4803902|         6346364|          |          |          |          |          |   Z68.37|   I10-1|                    |\n+-----------+----------------+----------+----------+----------+----------+----------+---------+--------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1523445409107_720488804","id":"20180411-164649_1051291475","dateCreated":"2018-04-11T16:46:49+0530","dateStarted":"2018-04-11T18:29:27+0530","dateFinished":"2018-04-11T18:29:30+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:413"},{"text":"dff.select(\"Patient_oid\",\"PatientVisit_oid\",\"ICD10_Code\", \"HCPCS_CD_1\",\"HCPCS_CD_2\",\"HCPCS_CD_3\",\"HCPCS_CD_4\",\"BMI_ICD10\",\"BP_ICD10\",\"DiagnosisGroup\").limit(10).show(20, false)\n\ndff.createOrReplaceTempView(\"DiagnosisGroup_View\")\n\n//sql(\"\"\"select DiagnosisGroup from DiagnosisGroup_View\"\"\").show(20,  False)\n\ndff.select(\"DiagnosisGroup\").show(10, false)","user":"admin","dateUpdated":"2018-04-11T18:34:18+0530","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+----------------+----------+----------+----------+----------+----------+---------+--------+----------------------------------------------+\n|Patient_oid|PatientVisit_oid|ICD10_Code|HCPCS_CD_1|HCPCS_CD_2|HCPCS_CD_3|HCPCS_CD_4|BMI_ICD10|BP_ICD10|DiagnosisGroup                                |\n+-----------+----------------+----------+----------+----------+----------+----------+---------+--------+----------------------------------------------+\n|1065908    |7081335         |          |          |          |          |          |E66.01   |I10-1   |     Cardiology, Pulmonary, Internal Medicine |\n|1065908    |6684852         |          |          |          |          |          |E66.01   |I10-1   |     Cardiology, Pulmonary, Internal Medicine |\n|1065908    |665AB2AFAF9B524A|I5022     |          |          |93005     |          |         |        |Cardiology                                    |\n|1065908    |6569499         |          |          |          |          |          |         |I10-2   |                                              |\n|1065908    |6346364         |          |          |          |          |          |E66.01   |I10-1   |     Cardiology, Pulmonary, Internal Medicine |\n|1065908    |5CE15C94868B89F2|I5022     |93306     |78451     |93005     |93458     |         |        |Cardiology                                    |\n|1065908    |449879CFA30A08C6|I5022     |93306     |78451     |93005     |93458     |         |        |Cardiology                                    |\n|4803902    |A6B28CE8DE42FAC6|I5022     |93306     |93350     |93005     |93458     |         |        |Cardiology                                    |\n|4803902    |832BF45E1D77CBB4|I5022     |          |          |93005     |          |         |        |Cardiology                                    |\n|4803902    |7388629         |          |          |          |          |          |Z68.37   |I10-1   |                                              |\n+-----------+----------------+----------+----------+----------+----------+----------+---------+--------+----------------------------------------------+\n\n+----------------------------------------------+\n|DiagnosisGroup                                |\n+----------------------------------------------+\n|     Cardiology, Pulmonary, Internal Medicine |\n|     Cardiology, Pulmonary, Internal Medicine |\n|Cardiology                                    |\n|                                              |\n|     Cardiology, Pulmonary, Internal Medicine |\n|Cardiology                                    |\n|Cardiology                                    |\n|Cardiology                                    |\n|Cardiology                                    |\n|                                              |\n+----------------------------------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1523447384459_357706697","id":"20180411-171944_1144707254","dateCreated":"2018-04-11T17:19:44+0530","dateStarted":"2018-04-11T18:34:19+0530","dateFinished":"2018-04-11T18:34:20+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:414"},{"user":"admin","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523451474992_1998481202","id":"20180411-182754_383723261","dateCreated":"2018-04-11T18:27:54+0530","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:415"}],"name":"DiagnosisGroup","id":"2DCV13566","angularObjects":{"2D4BQRDAZ:shared_process":[],"2D2M3UU13:shared_process":[],"2D31WF35G:shared_process":[],"2D5VVNH8P:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}